
    <!DOCTYPE html>
    <html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <title>Ë®ÄË®ÄÂíåÂ•πËÄÅÂÖ¨ÁöÑÂ±±‰∏ú‰πãÊóÖ</title>
        <link href="https://cdn.bootcdn.net/ajax/libs/leaflet/1.9.4/leaflet.min.css" rel="stylesheet">
        <style>
            :root {
                --bg: #0a0a0c; --card-bg: rgba(30, 30, 35, 0.75); --card-border: rgba(255, 255, 255, 0.1);
                --text-main: #FFFFFF; --text-sub: #9ca3af; --accent: #FF2E63;
                --accent-grad: linear-gradient(135deg, #FF2E63, #9D50FF); --glass: blur(20px);
            }
            body {
                font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
                background-color: var(--bg); color: var(--text-main); margin: 0; padding: 0; padding-bottom: 120px;
                overflow-x: hidden; -webkit-tap-highlight-color: transparent;
                background-image: radial-gradient(circle at 10% 20%, rgba(255, 46, 99, 0.15) 0%, transparent 40%), radial-gradient(circle at 90% 80%, rgba(157, 80, 255, 0.15) 0%, transparent 40%);
            }
            @keyframes heartbeat { 0% { transform: scale(1); } 15% { transform: scale(1.3); } 30% { transform: scale(1); } 45% { transform: scale(1.15); } 60% { transform: scale(1); } }
            @keyframes wave { 0% { box-shadow: 0 0 0 0 rgba(255, 46, 99, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(255, 46, 99, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 46, 99, 0); } }

            .header-box { padding: 60px 24px 20px 24px; }
            .sub-tag { display: inline-block; padding: 6px 12px; border-radius: 20px; background: rgba(255, 46, 99, 0.2); color: #FF80AB; font-size: 11px; font-weight: 700; letter-spacing: 1px; margin-bottom: 10px; border: 1px solid rgba(255, 46, 99, 0.3); }
            .main-title { font-size: 36px; font-weight: 800; line-height: 1.2; background: linear-gradient(to right, #fff, #ffcce0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; display: flex; align-items: center; gap: 10px; }
            .heart { font-size: 30px; animation: heartbeat 1.5s infinite; }

            .status-card { margin: 0 24px 24px; padding: 20px; background: var(--card-bg); border: 1px solid var(--card-border); backdrop-filter: var(--glass); border-radius: 24px; display: flex; justify-content: space-between; align-items: center; }
            .timer-box div:first-child { font-size: 12px; color: var(--text-sub); text-transform: uppercase; }
            .timer-box div:last-child { font-size: 20px; font-weight: 700; margin-top: 4px; font-variant-numeric: tabular-nums; }

            /* Èü≥‰πêÊéßÂà∂Âå∫ */
            .music-controls { display: flex; gap: 10px; }
            .music-btn { width: 44px; height: 44px; border-radius: 50%; background: rgba(255,255,255,0.05); border: 1px solid var(--card-border); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
            .music-btn.playing { border-color: #FF2E63; background: rgba(255,46,99,0.2); animation: wave 2s infinite; }

            .qq-btn { width: 44px; height: 44px; border-radius: 50%; background: #31C27C; /* QQ Music Green */ border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; }
            .qq-icon { width: 24px; height: 24px; fill: white; }

            .map-container { margin: 0 24px 24px; height: 200px; background: #1c1c1e; border-radius: 24px; border: 1px solid var(--card-border); overflow: hidden; position: relative; z-index: 1; }
            #map { width: 100%; height: 100%; background: #222; }
            .map-tag { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.7); color:white; padding: 4px 10px; border-radius: 10px; font-size: 10px; z-index: 500; font-weight: bold; }

            .list-box { background: var(--card-bg); border-radius: 20px; border: 1px solid var(--card-border); overflow: hidden; backdrop-filter: blur(10px); }
            .list-item { padding: 14px 20px; display: flex; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); }
            .list-item:last-child { border-bottom: none; }

            .check-section { margin: 0 24px 24px; }
            .check-head { display: flex; justify-content: space-between; margin-bottom: 10px; padding: 0 5px; }
            .c-circle { width: 20px; height: 20px; border: 2px solid #666; border-radius: 50%; margin-right: 12px; position: relative; }
            .list-item.done .c-circle { border-color: #32D74B; background: rgba(50,215,75,0.2); }
            .list-item.done .c-text { text-decoration: line-through; color: #666; }
            .c-del { margin-left: auto; color: #FF453A; padding: 5px; display: none; }
            .list-item.editing .c-del { display: block; }

            .wallet-card { margin: 0 24px 30px; padding: 24px; background: var(--accent-grad); border-radius: 24px; color: white; position: relative; overflow: hidden; box-shadow: 0 15px 40px -10px rgba(255, 46, 99, 0.4); }
            .wallet-card::after { content:''; position: absolute; top:-50%; right:-50%; width: 200px; height: 200px; background: radial-gradient(circle, rgba(255,255,255,0.2), transparent 70%); filter: blur(40px); }
            .add-btn { position: absolute; top: 24px; right: 24px; width: 32px; height: 32px; background: rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }

            .weather-wrap { display: flex; gap: 12px; overflow-x: auto; padding: 0 24px 24px; scrollbar-width: none; }
            .w-card { min-width: 90px; height: 100px; background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 20px; padding: 12px; display: flex; flex-direction: column; align-items: center; justify-content: space-between; }

            .day-group { margin-bottom: 30px; }
            .day-meta { padding: 0 28px 8px; display: flex; justify-content: space-between; align-items: flex-end; }
            .d-date { font-size: 20px; font-weight: 700; color: #fff; }
            .act-row { padding: 16px 20px; display: flex; align-items: center; border-bottom: 1px solid rgba(255,255,255,0.05); }
            .act-time { width: 50px; font-weight: 600; color: var(--text-sub); font-size: 14px; }
            .act-info { flex: 1; }
            .act-title { font-size: 16px; margin-bottom: 4px; color: #fff; }
            .act-sub { font-size: 12px; color: var(--text-sub); background: rgba(255,255,255,0.08); padding: 4px 8px; border-radius: 6px; }
            .edit-badge { color: #FF453A; font-size: 12px; margin-left: 10px; display: none; }
            .editing .edit-badge { display: block; }

            .dock { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: rgba(20, 20, 20, 0.9); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.15); padding: 10px 20px; border-radius: 100px; display: flex; gap: 20px; z-index: 100; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
            .dock-icon { font-size: 22px; cursor: pointer; opacity: 0.8; color: white; transition: 0.2s; }
            .dock-icon.active { color: #FF2E63; opacity: 1; transform: scale(1.2); }

            .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 999; display: none; align-items: center; justify-content: center; }
            .modal-bg.show { display: flex; }
            .modal-box { background: #1C1C1E; width: 80%; border-radius: 24px; padding: 24px; border: 1px solid rgba(255,255,255,0.1); }
            input { width: 100%; background: #2C2C2E; border: none; padding: 14px; border-radius: 12px; color: white; margin-bottom: 12px; box-sizing: border-box; font-size: 16px; }
            .btn-row { display: flex; gap: 10px; margin-top: 10px; }
            .btn { flex: 1; padding: 14px; border-radius: 12px; border: none; font-weight: 700; cursor: pointer; font-size: 16px; }
            .btn-ok { background: var(--accent); color: white; }

            .taxi-btns { display: flex; gap: 10px; margin: 0 24px 24px; }
            .taxi-item { flex: 1; background: var(--card-bg); border: 1px solid var(--card-border); padding: 15px; border-radius: 16px; text-align: center; font-weight: 600; cursor: pointer; }
            .taxi-card { background: white; color: black; padding: 40px 20px; border-radius: 24px; text-align: center; width: 85%; }
        </style>
    </head>
    <body>

        <div class="header-box">
            <div class="sub-tag">2026 ROMANTIC TRIP</div>
            <h1 class="main-title">Ë®ÄË®ÄÂíåÂ•πËÄÅÂÖ¨ÁöÑÂ±±‰∏ú‰πãÊóÖ <span class="heart">‚ù§Ô∏è</span></h1>
        </div>

        <div class="status-card">
            <div class="timer-box"><div>Next Adventure</div><div id="countdown">Calculating...</div></div>
            <div class="music-controls">
                <div class="music-btn" id="musicBtn" onclick="toggleMusic()">üéµ</div>
                <div class="qq-btn" onclick="openQQMusic()">
                    <svg class="qq-icon" viewBox="0 0 1024 1024"><path d="M512 0C229.248 0 0 229.248 0 512s229.248 512 512 512 512-229.248 512-512S794.752 0 512 0z m243.2 568.32c-2.56 20.48-15.36 33.28-35.84 38.4-15.36 2.56-30.72 5.12-46.08 7.68-15.36 2.56-33.28 0-43.52 12.8-12.8 15.36-12.8 38.4-12.8 58.88-2.56 12.8-2.56 28.16-5.12 40.96-7.68 40.96-46.08 69.12-87.04 64-43.52-5.12-74.24-43.52-69.12-84.48 5.12-38.4 38.4-66.56 76.8-66.56 7.68 0 12.8 0 20.48 2.56 0-5.12 0-12.8 0-17.92V360.96c0-43.52 28.16-81.92 69.12-92.16 43.52-12.8 89.6-23.04 135.68-35.84 25.6-7.68 53.76 7.68 61.44 33.28 7.68 25.6-7.68 53.76-33.28 61.44-33.28 10.24-66.56 17.92-102.4 25.6v128c46.08-12.8 84.48 15.36 97.28 58.88 5.12 17.92 2.56 28.16-5.12 28.16z"/></svg>
                </div>
            </div>
        </div>

        <div class="weather-wrap" id="weatherBox"></div>

        <div class="map-container" onclick="refreshMap()">
            <div class="map-tag">Travel Route</div>
            <div id="map"></div>
        </div>

        <div class="taxi-btns">
            <div class="taxi-item" onclick="showTaxi(0)">üöñ ÈùíÂ≤õÈÖíÂ∫ó</div>
            <div class="taxi-item" onclick="showTaxi(1)">üöñ ÁÉüÂè∞ÈÖíÂ∫ó</div>
        </div>

        <div class="check-section">
            <div class="check-head"><span style="font-weight:700;color:white">Ë°åÂâçÊ∏ÖÂçï</span><span style="font-size:12px; color:#FF80AB; cursor:pointer" onclick="openModal('addCheckModal')">Ôºã Ê∑ªÂä†</span></div>
            <div class="list-box" id="checkList"></div>
        </div>

        <div class="wallet-card">
            <div class="add-btn" onclick="openModal('exModal')">Ôºã</div>
            <div style="font-size:13px;opacity:0.8;font-weight:600">REMAINING BUDGET</div>
            <div style="font-size:40px;font-weight:800;margin:10px 0" id="remainBudget">¬•...</div>
            <div style="font-size:12px;opacity:0.6">Total Spent: ¬•<span id="totalSpent"></span></div>
        </div>

        <div id="itineraryBox"></div>

        <div class="dock">
            <div class="dock-icon" onclick="window.scrollTo({top:0, behavior:'smooth'})">üè†</div>
            <div class="dock-icon" id="editBtn" onclick="toggleEdit()">‚úé</div>
            <div class="dock-icon" onclick="resetAll()">‚Üª</div>
        </div>

        <div class="modal-bg" id="actModal">
            <div class="modal-box"><h3>ÁºñËæëÊ¥ªÂä®</h3><input id="actTime"><input id="actText"><input id="actSub"><div class="btn-row"><button class="btn" onclick="deleteAct()">Âà†Èô§</button><button class="btn btn-ok" onclick="saveAct()">‰øùÂ≠ò</button></div><div style="text-align:center;margin-top:10px;font-size:12px;color:#666" onclick="closeModal('actModal')">ÂèñÊ∂à</div></div>
        </div>
        <div class="modal-bg" id="exModal">
            <div class="modal-box"><h3>ËÆ∞‰∏ÄÁ¨î</h3><input id="exName" placeholder="È°πÁõÆ"><input id="exCost" type="number" placeholder="ÈáëÈ¢ù"><div class="btn-row"><button class="btn" onclick="closeModal('exModal')">ÂèñÊ∂à</button><button class="btn btn-ok" onclick="saveExpense()">‰øùÂ≠ò</button></div></div>
        </div>
        <div class="modal-bg" id="addCheckModal">
            <div class="modal-box"><h3>Ê∑ªÂä†Áâ©ÂìÅ</h3><input id="newCheckText"><div class="btn-row"><button class="btn" onclick="closeModal('addCheckModal')">ÂèñÊ∂à</button><button class="btn btn-ok" onclick="addCheckItem()">Ê∑ªÂä†</button></div></div>
        </div>
        <div class="modal-bg" id="taxiModal" onclick="this.classList.remove('show')">
            <div class="taxi-card" onclick="event.stopPropagation()"><div style="color:#888;margin-bottom:10px">SHOW TO DRIVER</div><div style="font-size:26px;font-weight:800;margin-bottom:20px" id="taxiBigName"></div><div style="font-size:18px;background:#f5f5f5;padding:15px;border-radius:12px" id="taxiBigAddr"></div></div>
        </div>

        <audio id="bgm" loop preload="auto" crossorigin="anonymous">
            <source src="https://cdn.pixabay.com/audio/2022/03/10/audio_ad2bc42c7f.mp3" type="audio/mpeg">
        </audio>

        <script src="https://cdn.bootcdn.net/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
        <script>
            const DATA = {"title": "Ë®ÄË®ÄÂíåÂ•πËÄÅÂÖ¨ÁöÑÂ±±‰∏ú‰πãÊóÖ", "subtitle": "2026 ROMANTIC TRIP", "start_date": "2026-02-09 09:10:00", "end_date": "2026-02-13 19:42:00", "bgm_url": "https://cdn.pixabay.com/audio/2022/03/10/audio_ad2bc42c7f.mp3", "qq_music_link": "https://y.qq.com/n/ryqq/playlist/8783363024", "budget": {"total": 4000, "fixed_spent": 1740.64}, "weather_locs": {"ÈùíÂ≤õ": {"lat": 36.0671, "lon": 120.3826}, "ÁÉüÂè∞": {"lat": 37.4638, "lon": 121.4479}, "È´òÈÇÆ": {"lat": 32.7833, "lon": 119.4333}}, "hotels": [{"city": "ÈùíÂ≤õ", "name": "Êµ∑ÂèãÈÖíÂ∫ó(‰∫îÂõõÂπøÂú∫Â∫ó)", "address": "Â∏ÇÂçóÂå∫ Âçó‰∫¨Ë∑Ø33Âè∑"}, {"city": "ÁÉüÂè∞", "name": "‰Ω†Â•ΩÈÖíÂ∫ó(Êª®Êµ∑ÂπøÂú∫Â∫ó)", "address": "ËäùÁΩòÂå∫ ‰∫åÈ©¨Ë∑Ø95Âè∑"}], "map_points": {"È´òÈÇÆ": [32.7833, 119.4333], "ÈùíÂ≤õ": [36.0671, 120.3826], "ÁÉüÂè∞": [37.4638, 121.4479], "ÂÖªÈ©¨Â≤õ": [37.4526, 121.6166]}, "default_checklist": [{"text": "Ë∫´‰ªΩËØÅ (Âéü‰ª∂)", "done": false}, {"text": "Â≠¶ÁîüËØÅ", "done": false}, {"text": "ÂÖÖÁîµÂÆù", "done": false}, {"text": "Ëá™ÊãçÊùÜ", "done": false}], "itinerary": [{"date": "2026-02-09", "weekday": "Âë®‰∏Ä", "city": "ÈùíÂ≤õ", "title": "ÊäµËææ & ÂÖ•‰Ωè", "activities": [{"time": "09:10", "type": "transport", "text": "È´òÈÇÆÁ´ôÂá∫Âèë", "sub": "D2866 (05ËΩ¶11A)"}, {"time": "14:30", "type": "hotel", "text": "Êµ∑ÂèãÈÖíÂ∫óÂÖ•‰Ωè", "sub": "Á†Å: GE2243"}, {"time": "16:30", "type": "sight", "text": "Â••Â∏Ü‰∏≠ÂøÉÊó•ËêΩ", "sub": "ÊÉÖ‰∫∫Âùù"}]}, {"date": "2026-02-10", "weekday": "Âë®‰∫å", "city": "ÈùíÂ≤õ", "title": "Â∞èÈ∫¶Â≤õ & ÂÖ´Â§ßÂÖ≥", "activities": [{"time": "09:00", "type": "sight", "text": "ÂÖ´Â§ßÂÖ≥", "sub": "‰∏áÂõΩÂª∫Á≠ë"}, {"time": "14:30", "type": "sight", "text": "Â∞èÈ∫¶Â≤õ", "sub": "ËçâÂú∞Èü≥‰πê‰ºö"}]}, {"date": "2026-02-11", "weekday": "Âë®‰∏â", "city": "ÁÉüÂè∞", "title": "ËΩ¨ÊàòÁÉüÂè∞", "activities": [{"time": "10:29", "type": "transport", "text": "ÂâçÂæÄÁÉüÂè∞", "sub": "C6568 (04ËΩ¶08D)"}, {"time": "14:00", "type": "hotel", "text": "‰Ω†Â•ΩÈÖíÂ∫óÂÖ•‰Ωè", "sub": "Á†Å: DGJ253"}]}, {"date": "2026-02-12", "weekday": "Âë®Âõõ", "city": "ÁÉüÂè∞", "title": "ÂÖªÈ©¨Â≤õÁéØÂ≤õ", "activities": [{"time": "10:30", "type": "activity", "text": "ÁßüËΩ¶ÁéØÂ≤õ", "sub": "Êµ∑Ëû∫Ê¥û"}, {"time": "16:00", "type": "sight", "text": "ÁúãÊó•ËêΩ", "sub": "ËøîÁ®ã"}]}, {"date": "2026-02-13", "weekday": "Âë®‰∫î", "city": "È´òÈÇÆ", "title": "ËøîÁ®ã", "activities": [{"time": "15:12", "type": "transport", "text": "D2872 ËøîÁ®ã", "sub": "ÁÉüÂè∞->È´òÈÇÆ"}]}]};
            let state = { expenses: [], checklist: JSON.parse(JSON.stringify(DATA.default_checklist)), itinerary: JSON.parse(JSON.stringify(DATA.itinerary)), editing: false };
            let target = {d:-1, a:-1};
            let map = null;

            async function init() {
                const local = localStorage.getItem('final_qq_v2');
                if(local) state = {...state, ...JSON.parse(local)};

                renderTimer(); renderWeather(); renderBudget(); renderChecklist(); renderItinerary();
                setTimeout(initMap, 500);
            }

            // === Èü≥‰πêÈÄªËæë ===
            function toggleMusic() {
                const audio = document.getElementById('bgm');
                const btn = document.getElementById('musicBtn');
                if (audio.paused) {
                    audio.play().then(() => btn.classList.add('playing')).catch(()=>alert('ËØ∑ÂÖàÁÇπÂáªÈ°µÈù¢‰ªªÊÑèÂ§Ñ'));
                } else {
                    audio.pause();
                    btn.classList.remove('playing');
                }
            }

            function openQQMusic() {
                // ÊâìÂºÄ QQ Èü≥‰πêÈìæÊé•
                window.location.href = DATA.qq_music_link;
            }

            // --- Map ---
            function initMap() {
                if(map) return;
                map = L.map('map', {zoomControl:false, attributionControl:false}).setView([36.5, 121.0], 7);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {maxZoom: 19}).addTo(map);
                const pts = [];
                Object.values(DATA.map_points).forEach(p => {
                    L.circleMarker(p, {radius:6, color:'#FF2E63', fillColor:'#FF2E63', fillOpacity:1}).addTo(map);
                    pts.push(p);
                });
                if(pts.length>1) L.polyline(pts, {color:'#FF2E63', weight:3, dashArray:'5,5'}).addTo(map);
            }
            function refreshMap() { if(map) map.invalidateSize(); }

            // --- Edit ---
            function toggleEdit() { state.editing=!state.editing; document.getElementById('editBtn').classList.toggle('active', state.editing); renderItinerary(); renderChecklist(); }
            function renderItinerary() {
                document.getElementById('itineraryBox').innerHTML = state.itinerary.map((day, dIdx) => `
                    <div class="day-group">
                        <div class="day-meta"><div class="d-date">${day.date.slice(5)} ${day.weekday}</div><div class="d-city" style="color:#FF80AB;font-weight:700">${day.city}</div></div>
                        <div class="list-box">
                            ${day.activities.map((act, aIdx) => `
                                <div class="act-row" onclick="clickAct(${dIdx}, ${aIdx})">
                                    <div class="act-time">${act.time}</div>
                                    <div class="act-info"><div class="act-title">${act.text}</div><div class="act-sub">${act.sub}</div></div>
                                    ${state.editing ? '<div class="edit-badge">‚úé</div>' : ''}
                                </div>
                            `).join('')}
                            <div style="padding:15px;text-align:center;color:#FF80AB;font-size:12px;border-top:1px solid rgba(255,255,255,0.05);cursor:pointer" onclick="addAct(${dIdx})">Ôºã Ê∑ªÂä†Ê¥ªÂä®</div>
                        </div>
                    </div>
                `).join('');
            }
            function clickAct(d, a) { target = {d, a}; const act = state.itinerary[d].activities[a]; document.getElementById('actTime').value=act.time; document.getElementById('actText').value=act.text; document.getElementById('actSub').value=act.sub; openModal('actModal'); }
            function saveAct() { const t=document.getElementById('actTime').value, tx=document.getElementById('actText').value, s=document.getElementById('actSub').value; state.itinerary[target.d].activities[target.a]={time:t, text:tx, sub:s}; save(); renderItinerary(); closeModal('actModal'); }
            function deleteAct() { if(confirm('Âà†Èô§?')) { state.itinerary[target.d].activities.splice(target.a,1); save(); renderItinerary(); closeModal('actModal'); } }
            function addAct(d) { state.itinerary[d].activities.push({time:"00:00", text:"Êñ∞ËÆ°Âàí", sub:"ÁÇπÂáª‰øÆÊîπ"}); save(); renderItinerary(); clickAct(d, state.itinerary[d].activities.length-1); }

            // --- Checklist ---
            function renderChecklist() {
                document.getElementById('checkList').innerHTML = state.checklist.map((item, idx) => `
                    <div class="list-item ${item.done?'done':''} ${state.editing?'editing':''}">
                        <div class="c-circle" onclick="toggleCheck(${idx})"></div>
                        <div class="c-text" style="flex:1;color:white" onclick="toggleCheck(${idx})">${item.text}</div>
                        ${state.editing ? `<div class="c-del" onclick="delCheck(${idx})">‚úï</div>` : ''}
                    </div>
                `).join('');
            }
            function toggleCheck(idx) { state.checklist[idx].done=!state.checklist[idx].done; save(); renderChecklist(); }
            function delCheck(idx) { state.checklist.splice(idx,1); save(); renderChecklist(); }
            function addCheckItem() { const t=document.getElementById('newCheckText').value; if(t){ state.checklist.push({text:t,done:false}); save(); renderChecklist(); closeModal('addCheckModal'); document.getElementById('newCheckText').value=''; } }

            // --- Utils ---
            function renderBudget() { const u=state.expenses.reduce((s,i)=>s+Number(i.cost),0); const t=DATA.budget.fixed_spent+u; document.getElementById('remainBudget').innerText = `¬•${(DATA.budget.total-t).toFixed(0)}`; document.getElementById('totalSpent').innerText=t.toFixed(0); }
            function saveExpense() { const n=document.getElementById('exName').value, c=document.getElementById('exCost').value; if(n&&c){ state.expenses.push({name:n, cost:c}); save(); renderBudget(); closeModal('exModal'); document.getElementById('exName').value='';document.getElementById('exCost').value=''; } }
            function renderTimer() { setInterval(()=>{ const diff=new Date(DATA.start_date)-new Date(); const d=Math.floor(diff/86400000); document.getElementById('countdown').innerText=diff>0?`${d} DAYS`:"Enjoy!"; },1000); }
            function renderWeather() { const box=document.getElementById('weatherBox'); box.innerHTML=Object.keys(DATA.weather_locs).map(c=>`<div class="w-card" id="w-${c}"><div style="font-size:12px;opacity:0.7">${c}</div><div>--¬∞</div></div>`).join(''); Object.keys(DATA.weather_locs).forEach(async c=>{ try{const{lat,lon}=DATA.weather_locs[c];const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);const d=await r.json();const w={0:"‚òÄÔ∏è",1:"üå§",2:"‚òÅÔ∏è",3:"‚òÅÔ∏è",51:"üåß"};document.getElementById(`w-${c}`).innerHTML=`<div style="font-size:12px;font-weight:700;color:#FF80AB">${c}</div><div style="font-size:24px">${w[d.current_weather.weathercode]||"?"}</div><div style="font-size:18px">${Math.round(d.current_weather.temperature)}¬∞</div>`;}catch(e){} }); }
            function openModal(id){document.getElementById(id).classList.add('show')}
            function closeModal(id){document.getElementById(id).classList.remove('show')}
            function showTaxi(i){const h=DATA.hotels[i]; document.getElementById('taxiBigName').innerText=h.name; document.getElementById('taxiBigAddr').innerText=h.address; openModal('taxiModal'); }
            function save(){localStorage.setItem('final_qq_v2', JSON.stringify(state))}
            function resetAll(){if(confirm('Reset?')){localStorage.removeItem('final_qq_v2');location.reload()}}

            init();
        </script>
    </body>
    </html>
    